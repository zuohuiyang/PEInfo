# PEInfo（V1）界面线框图

本文用于快速对齐 GUI 界面布局与交互，不绑定具体 UI 技术栈（Qt / WinUI3 / WPF 均可落地）。

## 1) 主窗口（默认：Summary）

```
┌───────────────────────────────────────────────────────────────────────────────┐
│ PEInfo                                                            _ □  X      │
├───────────────────────────────────────────────────────────────────────────────┤
│ 文件(F)  编辑(E)  视图(V)  工具(T)  帮助(H)                                   │
├───────────────────────────────────────────────────────────────────────────────┤
│ [打开] [刷新]   [导出 JSON] [导出 Text]   [复制摘要]        解析状态：就绪     │
├───────────────────────────────────────────────────────────────────────────────┤
│ 文件：C:\samples\foo.dll                                                        │
│ 大小：12.4 MB   时间戳：2024-10-11 12:03:22   SHA256：A1B2…9F0E  [复制]        │
│ 签名：✓ 已签名（验证：未执行）     PDB：有（RSDS）     导入：123  导出：8       │
├───────────────────────────────────────────────────────────────────────────────┤
│ ┌───────────────┐  ┌───────────────────────────────────────────────────────┐  │
│ │ 概览卡片       │  │ Tabs: [Summary] [Sections] [Imports] [Exports]        │  │
│ │               │  │       [Debug/PDB] [Signature] [Hash]                  │  │
│ │ 关键结论       │  ├───────────────────────────────────────────────────────┤  │
│ │ - 体系结构 x64 │  │ Summary（概览内容区）                                  │  │
│ │ - Subsystem GUI│  │                                                       │  │
│ │ - Entry: 0x... │  │  • Machine: AMD64                                     │  │
│ │ - ImageBase ...│  │  • Subsystem: Windows GUI                             │  │
│ │ - 节：6         │  │  • EntryPoint: 0x00012340                             │  │
│ │ - 可疑提示：0   │  │  • ImageBase: 0x0000000140000000                      │  │
│ │               │  │  • SizeOfImage: 0x0012A000                              │  │
│ │ 快捷跳转        │  │  • Characteristics: ...                              │  │
│ │ [Sections]      │  │                                                       │  │
│ │ [Imports]       │  │  Debug: RSDS, PDB: C:\...\foo.pdb                     │  │
│ │ [Signature]     │  │  Signature: Present                                   │  │
│ │ [Hash]          │  │                                                       │  │
│ └───────────────┘  └───────────────────────────────────────────────────────┘  │
├───────────────────────────────────────────────────────────────────────────────┤
│ 状态栏：打开文件后自动解析；错误/警告在此提示；右侧显示耗时 36ms              │
└───────────────────────────────────────────────────────────────────────────────┘
```

交互要点
- 打开/拖拽文件后自动解析，解析中工具栏按钮可用性合理（导出可置灰）。
- 概览卡片用于“快速判断”，右侧 Tab 用于“细节查阅”。

## 2) Sections Tab（节表）

```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Sections   过滤：[ .text ] (支持按 Name / Flags / 可疑提示过滤)   [清空]       │
├───────────────────────────────────────────────────────────────────────────────┤
│ Name   RVA       VSize     RawSize   Entropy  Flags                提示        │
│ .text  00001000  0008A000  0008A200  6.42     RX                   -           │
│ .rdata 0008C000  00026000  00026200  5.12     R                    -           │
│ .data  000B2000  00004000  00001000  3.01     RW                   Raw<Virt    │
│ .rsrc  000B6000  0000A000  0000A200  7.88     R                    高熵         │
│ ...                                                                           │
└───────────────────────────────────────────────────────────────────────────────┘
```

右键菜单（可选）
- 复制选中行 / 复制整表（TSV）

## 3) Imports Tab（导入/延迟导入）

布局方案 A（树形 + 详情）
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Imports   过滤：[ kernel32!CreateFileW ]   [仅显示匹配]   视图：树形 ▼         │
├───────────────────────────────────────────────────────────────────────────────┤
│ ┌─────────────────────────────┐  ┌─────────────────────────────────────────┐ │
│ │ DLL 列表                     │  │ 函数列表                                │ │
│ │ ▸ KERNEL32.dll (34)          │  │ CreateFileW                              │ │
│ │ ▸ USER32.dll   (12)          │  │ ReadFile                                 │ │
│ │ ▾ ADVAPI32.dll (8)           │  │ RegOpenKeyExW                            │ │
│ │    ...                        │  │ ...                                     │ │
│ └─────────────────────────────┘  └─────────────────────────────────────────┘ │
├───────────────────────────────────────────────────────────────────────────────┤
│ Delay Imports：有/无  [切换到 Delay Imports 子页]                              │
└───────────────────────────────────────────────────────────────────────────────┘
```

布局方案 B（单表格）
- 列：DLL、Name、Hint/Ordinal、RVA/IAT（若可得）

## 4) Exports Tab（导出）

```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Exports   过滤：[ DllMain ]   [清空]                                          │
├───────────────────────────────────────────────────────────────────────────────┤
│ Ordinal  RVA       Name                 Forwarder                              │
│ 1        00012010  FooInit              -                                      │
│ 2        00012120  FooDoWork            -                                      │
│ 3        00012230  DllMain              -                                      │
└───────────────────────────────────────────────────────────────────────────────┘
```

## 5) Debug/PDB Tab

```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Debug/PDB                                                                     │
├───────────────────────────────────────────────────────────────────────────────┤
│ Debug Directory：RSDS                                                          │
│ PDB 路径：C:\build\obj\foo.pdb                                 [复制]          │
│ GUID：{12345678-1234-1234-1234-123456789ABC}                 Age：2  [复制]    │
│ 备注：若未包含 PDB 信息，显示“无/不可用”。                                      │
└───────────────────────────────────────────────────────────────────────────────┘
```

## 6) Signature Tab（签名）

```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Signature                                                   [验证签名]        │
├───────────────────────────────────────────────────────────────────────────────┤
│ 是否包含 Authenticode：是                                                        │
│ 签名状态：已签名（未验证）                                                       │
│                                                                              │
│ 验证结果：-                                                                    │
│ 详情：                                                                        │
│  -                                                                          │
│                                                                              │
│ 证书信息（若可得）：                                                           │
│  - Subject: ...                                                               │
│  - Issuer:  ...                                                               │
│  - Valid:   ...                                                               │
└───────────────────────────────────────────────────────────────────────────────┘
```

交互要点
- “验证签名”可能依赖系统证书链；失败需要清晰原因（无签名/链不受信任/格式不支持）。

## 7) Hash Tab（哈希）

```
┌───────────────────────────────────────────────────────────────────────────────┐
│ Hash                                                                      │
├───────────────────────────────────────────────────────────────────────────────┤
│ MD5    ： 0123456789abcdef0123456789abcdef                      [复制]        │
│ SHA1   ： 0123456789abcdef0123456789abcdef01234567              [复制]        │
│ SHA256 ： 0123456789abcdef...                                    [复制]        │
│                                                                              │
│ [复制全部]（按行拼接，适合粘贴到工单/IM）                                       │
└───────────────────────────────────────────────────────────────────────────────┘
```

## 8) 打开文件/拖拽态与解析进度

空态（未打开文件）
```
┌───────────────────────────────────────────────────────────────────────────────┐
│ 将 EXE/DLL/SYS 拖到此处，或点击 [打开]                                         │
│                                                                              │
│ 支持：.exe .dll .sys .ocx                                                     │
└───────────────────────────────────────────────────────────────────────────────┘
```

解析中（不冻结 UI）
- 状态栏显示：正在解析…（进度环/忙碌指示）+ 耗时
- Tab 内容区显示 Skeleton/占位提示

## 9) 错误弹窗（示例）

```
┌─────────────────────────────────────────────────────────┐
│ 打开失败                                                 │
├─────────────────────────────────────────────────────────┤
│ 不是有效的 PE 文件，或文件已损坏。                       │
│                                                         │
│ 详细信息：                                               │
│  - Magic 不匹配 / PE header 不完整 / 读取失败 ...        │
│                                                         │
│ [复制详情]                               [关闭]          │
└─────────────────────────────────────────────────────────┘
```

